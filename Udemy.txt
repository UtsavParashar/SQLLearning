SQL Theory -

It's a declarative language i.e you don't have to tell sql how to divide the task and get the things done. It has SQL optimizer to create sub task and do the job.
You just need to tell SQL, get me this data and you are done.
Concentration is what you require rather then how to find what you require.

As a declarative language, it has following 4 components:
1. DDL - Data Definition Language
2. DML - Data Manipulation Language
3. DCL - Data Control Language
4. TCL - Transaction Control Language

DDL
----
SQLs Syntax - Comprises of several types of statements that allow you to perform various commands and operations.

DDL - A set of statements that allow the user to define or modify data structures and objects, such as tables.

Create Statement - Create Database and Database objects like tables.
-----------------
Syntax :
    CREATE OBJECT_TYPE object_name;

Eg. CREATE TABLE table_name (column_name, datetype);
CREATE TABLE  sales (purchare_number, INT);

It is a common practise to have same name of the database and its main table.

Alter Statement - Alter a table by adding removing renaming column names
---------------
Eg. ALTER TABLE sales
ADD COLUMN purchase_date DATE;


DROP/Delete a table/database:
-----------------------------
DROP OBJECT object_name;
DROP TABLE sales;

RENAME - To rename a table/column etc.
-------
RENAME TABLE sales TO customer_sales;

TRUNCATE Statement:
-------------------
To clear all data i.e elements of the table but the keep the schema of the table, we can go with TRUNCATE statement.
TRUNCATE OBJECT object_name;
TRUNCATE TABLE customers;

SQL Keywords: ~ RESERVED WORDS
-------------
ADD, RENAME, ALTER(ADD, REMOVE), DROP, TRUNCATE etc

Keywords in SQL cannot be variable names - objects and databases cannot have names that coincides with SQL keywords.


DML - Data Manipulation Language
================================
The statements that allows us to manipulate data in the tables of a database.

SELECT Statement - used to retrieve data from db objects like tables.
----------------- Eg: SELECT * FROM TABLE;
SELECT * FROM sales;

Generalized version
SELECT ... FROM ... WHERE

INSERT Statement - used to insert data into tables.
-----------------
It goes hand in hand with keywords -- INTO and VALUES

Generalized version
INSERT INTO ... VALUES

Eg
INSERT INTO sales (purchare_number, purchase_date) VALUES (1, '2021-01-01')  -- OR
INSERT INTO sales VALUES (2, '2021-03-02') -- Since we have two columns, values will be entered in positional sequence.

UPDATE Statement - allows you to update/renew existing data of your tables.
----------------
It goes hand in hand with

Generalized version
UPDATE .... SET .... WHERE

Eg. UPDATE sales
    SET  purchase_date='2021-03-01'
    WHERE purchare_number=1;

DELETE Statement - It works similar to the TRUNCATE statement from DDL.
----------------
With a diff - DELETE vs TRUNCATE
TRUNCATE removes all the data from the table i.e clear all elements from the table whereas
DELETE can either remove all elements or we can precisely specify what all rows are to be removed by providing the condition with where clause.

DELETE FROM sale; -- works similar to TRUNCATE i.e
TRUNCATE TABLE sales;

Generalized version -- DELETE ... FROM ... WHERE

But if we want to delete a row based on condition then we can go with:
DELETE FROM sales
WHERE purchase_date='2021-03-01'; -- This will remove only one horizontal entity from the table.

Generalized versions of DML Language Statements:
SELECT -- SELECT ... FROM ... WHERE
INSERT -- INSERT INTO ... VALUES
UPDATE -- UPDATE ... SET ... WHERE
DELETE -- DELETE ... FROM ... WHERE

DCL - Data Control Language
=============================
It includes two statements
GRANT and REVOKE - allows us to make rights users have in a db.

GRANT - GRANT gives or grants certain permissions to users
-------
Syntax - GRANT type_of_permission
         ON database_name.table_name
         TO 'username'@'localhost'

From this statement a user can be granted a certain permission (SELECT/INSERT/UPDATE/DELETE/CREATE/ALTER(ADD,REMOVE)/DROP/TRUNCATE/RENAME) to one of many tables of a db.

Eg. GRANT SELECT
    ON salesDb.customers_table
    TO 'frank'@'euhost'

This statement will provide ONLY select permission to user frank on table customers_table of salesDb database.

To grant all permission to frank on salesDb we can use:
GRANT ALL
ON salesdb.*
TO 'frank'@'euhost'

Database Admin - People who have complete rights to the db are db admin they can grant access to users and can revoke it.
---------------

REVOKE - used to revoke permissions of the users, it is the exact opposite of GRANT.
-------
Eg. REVOKE SELECT
    ON salesdb.customers_table
    FROM 'frank'@'euhost'


TCL - Transaction Control Language
===================================
Not every change you make to a db is saved automatically.

COMMIT Statement - All the changes which you have made related to INSERT, UPDATE, DELETE will not be saved permanently until you commit them.
----------------
Commit will save the changes you have made and will have other users have access to the modified version of the database.
Once Commit is run, changes cannot be undone.

Eg. To Update last name of a user
UPDATE customer_table
SET lastname = 'Kumar'
WHERE firstname='Ramesh';

After running above statement, rest of the users using the db won't know that you have updated the lastname. In order to reflect the changes to other users, you will have to add commit to the statement.

UPDATE customer_table
SET lastname='Kumar'
WHERE firstname='Ramesh'
COMMIT;

Now the updated information will be available to the users.
If you are db admin, u might have to run Commit 20 times a day hence committed states can accrue.

ROLLBACK clause - This clause will let you make a step back.
---------------
It allows you to undo any changes you have made an don't want to save permanently.

eg. ROLLBACK;

This will remove all changes and move to last committed state.


Revision:
DDL - CREATE/DESCRIBE DATA
    CREATE - CREATE TABLE table_name;
    ALTER - ALTER TABLE table_name ADD COLUMN column_name column_type;
    RENAME - RENAME TABLE table_name;
    DROP - DROP TABLE table_name;
    TRUNCATE - TRUNCATE TABLE table_name;

DML - MANIPULATE DATA
    SELECT - SELECT * FROM table_name  WHERE condition;
    INSERT - INSERT INTO table_name  WHERE condition;
    UPDATE - UPDATE table_name SET values WHERE condition;
    DELETE - DELETE cols FROM table_name WHERE condition;

DCL - CONTROL DATA THROUGH ACCESS
    GRANT - GRANT SELECT ON table_name TO 'user_name'@'hostname';
    REVOKE - REVOKE SELECT ON table_name FROM  'user_name'@'hostname';

TCL - COMMIT AND REVOKE CHANGES
    COMMIT - COMMIT;
    ROLLBACK - ROLLBACK;

Basic Database Terminology
==========================
The goal of the db is is to organize huge amounts of data that can be quickly retrieved.

What is relational database?
Database where there is relationship between tables also called as relations in the form of primary - foreign key. Hence when we need data from k of n tables then we work with only k tables(i.e only k tables are loaded) hence data is efficiently retrieved.
It is based on relational algebra.
i.e 3 tables == 3 relations
The smallest unit in the entire system that can carry integral logical meaning.

Two ways to design a DB:
------------------------
ER Diagram - Draw a diagram(like flowchart) showing the mappings of all tables and their connections through arrows.
Relational Schema - Create a rectangle for each table with tablename at the top and columns in rectangle, do same for all tables in a db and connect them through arrows.
When we combine relational schema it forms the database schema.


Primary Key:
============
A column or a set of columns whose value exists and is unique for every record in a table is a candidate of primary key.
Each table can have one and only one Primary key. In one table we cannot have 3-4 primary keys.
That Primary key can be a single Field(Column) like Purchase_id in sales table where purchase_id will have unique sequence of numbers.
Or two columns together can be combined to form a primary key eg purchase_number + date_of_purchase.
Only condition being Primary key should be unique.
Primary keys are also called unique identifiers of a table.
Primary keys cannot contain null values.

In Relational schema -
Table Name is at the top.
Then the primary key column is placed at the to of all other columns as is underlined.
Relational schema for a sales table having purchase_id as a primary key.

        Sales
 =======================
|    purchase_id        |
|    ------------       |
|    date_of_purchase   |
|    customer_id        |
|    item_code          |
 -----------------------

Not all tables you work with will have a primary key.

Foreign Key:
-----------
Suppose we have customers info like firstname, lastname, emailaddress, numberofcomplaints which is required in more than one table then other then having redundant info in different tables we can create Customers table with a primary key as customer_id and this can be mapped to other tables where it will behave as Foreign key.
primary key customer_id can have different column name in different tables like ID, cust_id etc but it can be mapped as Foreign key and Primary key combination.
Eg. In sales table we same name for column customer_id for foreign key which maps to primary key customer_id of Customers table.

Relational schema:
Foreign key in one table should be shown by (FK) around the column name and it should point an arrow to the primary key of other table it is mapping.
Eg. customer_id which is FK in Sales will point to primary key customer_id of Customer table.
Similarly there can be other tables like Items with item_code as FK in Sales table and primary key in Items table

                                             Customers
                                      =================================
        Sales              |-------> |      customer_id                 |
 =======================   |         |      ------------                |
|    purchase_id        |  |         |      first_name                  |
|    ------------       |  |         |      last_name                   |
|    date_of_purchase   |  |         |      email_address               |
|    customer_id  (FK)  |--          |      number_of_complaints        |
|    item_code    (FK)  |--|          ----------------------------------
 -----------------------   |
                           |
                           |                    Items
                           |         ===================================
                           |------->|           item_code               |
                                    |           ----------              |
                                    |           item                    |
                                    |           unit_price              |
                                    |           company_id              |
                                     -----------------------------------

 if the foreign key inserted in the Sales table does not have a corresponding value in Customers table then sql will raise an error.

 HENCE, FOREIGN KEYS ARE IDENTIFIERS THAT IDENTIFIES RELATIONS BETWEEN TABLES BUT NOT THE TABLES THEMSELVES.

 Relational Schema - Unique Keys and Null Values
 ================================================
 Unique key is used whenever you would like to specify that you don't want to see duplicate data in a given field.
 Unique keys are columns which should have unique values but unlike primary key
 1. It can contain null values
 2. There can be more than one unique columns in a table.

 Similar to primary key:- Unique key can be formed by combination of one or more columns.

                                             Customers
                                       =================================
         Sales              |-------> |      customer_id                 |
  =======================   |         |      ------------                |
 |    purchase_id        |  |         |      first_name                  |
 |    ------------       |  |         |      last_name                   |
 |    date_of_purchase   |  |         |      email_address               |
 |    customer_id  (FK)  |--          |      number_of_complaints        |
 |    item_code    (FK)  |--|          ----------------------------------
  -----------------------   |
                            |
                            |                    Items
                            |         ===================================
                            |------->|           item_code               |                      Companies
                                     |           ----------              |               ===================================
                                     |           item                    |      |--->   |       company_id                  |
                                     |           unit_price              |      |       |       -----------                 |
                                     |           company_id   (FK)       |------|       |       headquarters_phone_number   |
                                      -----------------------------------               |       company_name                |
                                                                                         -----------------------------------

Relationships
==============
Relationships tell you how much of the data from a foreign key field can be seen in the primary key column of the table the data is related to and vice versa.

customer_id column in Sales can have many duplicates as a customer can buy many items but each customer can have a single entry(customer_id) in Customers table.
Hence Customers to Sales is - One to Many relationship AND
Sales to Customers is - Many to One relationship

In relational diagram, one to many relationship is shown as >| AND
many to one relationship is shown as ||

                                             Customers
                               Many-One  =================================
         Sales                 |---||->|      customer_id                 |
  =======================      |       |      ------------                |
 |    purchase_id        |     |       |      first_name                  |
 |    ------------       |     |       |      last_name                   |
 |    date_of_purchase   |     |       |      email_address               |
 |    customer_id  (FK)  |\|---|       |      number_of_complaints        |
 |    item_code    (FK)  |/|             ----------------------------------
  ----------------------- One-Many

These are called cardinality constraints.
 > | define max and min relationship respectively.
 M N - define infinite relationship
 O - Optional Relationship which in this case when it was not necessary for a registered person to purchase an item.

 Few types of relationship-
 one to one
 one to many
 many to many
 many to one

Hence, Relational Schemas
- represents the concept db admins must implement
- depict how a database is organized
- blueprints, or a plan for a db

Relational Schemas will help you immensely while writing your queries.

Section 5 - First Steps in SQL
------------------------------
Let's create a db first.

Syntax: CREATE DATABASE [IF NOT EXISTS] dbname; -- OR
CREATE SCHEMA IF NOT EXISTS dbname;


Let's dissect the above statement.

CREATE DATABASE - Creates a db as an abstract unit it means after this statement db will not create any data but act as an object which is ready to persist information.

IF NOT EXISTS - verifies if the db with the same name exists already.
This won't prevent(impede) us from creating a db with the same name. The bracket around mean the statement is optional (we can either type or omit the statement),even if we don't include it, it will run anyway. It is always useful to include it because when we are working with large amount of datasets it reduces potential errors

dbname - It is always suggested to give a short name but at the same time as related to content of data as possible.

The SQL code is not case sensitive.
We can use quotes around dbname or without quotes.

; - Semi colon is the statement terminator. It is often true that the statement will run properly without it but in longer scripts when the code contains more than one statement. The semi colon is indispensable.
make a habit of using semi colon.

There can be many db when working through Workbench, in that case we can apply USE command to use a particular db.
USE Sales;

Introduction to Datatypes:
--------------------------
We must specify the type of the data that will be inserted in each column of the table.
Different datatypes represent different types of information that can be contained in a specific column.

String Data Types: The text format is sql is called string.
Datatypes containing strings are also called alphanumeric datatypes.
Eg. James will be treated a string datatype.

CHAR - character string - Fixed length string or called FIXED STORAGE DATATYPE
    max (size)limit is 255
    For CHAR(5) - Here 5 means the max symbols(chars) we are allowed to use in writing a value in this format.
    if a string -
        'James' is stored, it will take 5 bytes storage
        'Bob' is stored, it will also take 5 bytes storage
    Then why use CHAR when it takes fixed bytes?
        Two reasons -
            It is around 50% faster compared to VARCHAR.
            It can be used in situations where we need to store company acronyms with 4 chars like GOOG, AMZN, MSFT then we can go with CHAR(4).

VARCHAR - Variable Character - Variable length string
    Max (size)limit is 65535
    For VARCHAR(5)
    if a string -
            'James' is stored, it will take 5 bytes storage
            'Bob' is stored, it will also take 3 bytes storage
    Example - Store password which is not more than 10 chars, we can use VARCHAR as it will use storage based on size of password.

ENUM - Enumerate - It is particularly useful when we know beforehand what type of column are we going to deal with.
    It is same as choice, like to insert the Gender of a person you can define ENUM('M', 'F') then mysql will show error if you want to store value other than M or F.
    MySql will show an error if you attempt to insert any value different from M or F.

Numeric Types -
===============
INTEGERS
FIXED-POINT
FLOATING-POINT

INTEGERS - When we want to store whole numbers with no decimal points. Eg - 5, 15, -200, 1000
--------
Integers(signed/unsigned) signed includes negative values, then we can go with Integers.
Integers are further divided into few types based on size.
By default, INTEGER type are signed.
If we want to use a range containing only positive, 'unsigned' values, we will have to specify this in our query.

INT Type       size(bytes)              minimum value(signed/unsigned)                     maximum value(signed/unsigned)
TINYINT         1                           -128                                                127
                                               0                                                255
SMALLINT        2                         -32768                                              32767
                                               0                                              65535
MEDIUMINT       3                     -8,388,608                                          8,388,607
                                               0                                         16,777,215
INT             4                 -2,147,483,648                                      2,147,483,647
                                               0                                      4,294,967,295
BIGINT          8     -9,223,372,036,854,775,808                          9,223,372,036,854,775,807
                                               0                         18,446,744,073,709,551,615

Why not just use BIGINT all the time?
Answers comes in computer's processing speed, if in a field you are sure that you won't need an integer smaller than 0 and greater than 100, TINYINT will do the job perfectly and you would not need more storage space per data point.
A smaller integer type may suffice and increase the processing speed.


FIXED-POINT
-----------
DECIMAL
NUMERIC

Let's first get used to two concepts -
precision and scale.
precision - refers to number of digits in a number.
scale - number of digits right to the decimal point in a number.


